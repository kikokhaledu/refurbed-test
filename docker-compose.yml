services:
  backend:
    build:
      context: .
      dockerfile: backend/Dockerfile
    environment:
      BACKEND_HOST: "${BACKEND_HOST:-0.0.0.0}"
      BACKEND_PORT: "${BACKEND_PORT:-8080}"
      BACKEND_DATA_DIR: "${BACKEND_DATA_DIR:-data}"
      BACKEND_CACHE_TTL_SECONDS: "${BACKEND_CACHE_TTL_SECONDS:-30}"
      BACKEND_CORS_ALLOW_ORIGIN: '${BACKEND_CORS_ALLOW_ORIGIN:-*}'
    ports:
      - "${BACKEND_PORT:-8080}:${BACKEND_PORT:-8080}"
    volumes:
      - ./backend/data:/app/data:ro
    restart: unless-stopped

  frontend:
    build:
      context: .
      dockerfile: assignment_vue/frontend-vue/Dockerfile
    environment:
      VITE_API_BASE_URL: "${VITE_API_BASE_URL:-}"
      VITE_BACKEND_PORT: "${VITE_BACKEND_PORT:-${BACKEND_PORT:-8080}}"
      FRONTEND_HOST: "${FRONTEND_HOST:-0.0.0.0}"
      FRONTEND_PORT: "${FRONTEND_PORT:-5173}"
    ports:
      - "${FRONTEND_PORT:-5173}:${FRONTEND_PORT:-5173}"
    depends_on:
      - backend
    restart: unless-stopped
